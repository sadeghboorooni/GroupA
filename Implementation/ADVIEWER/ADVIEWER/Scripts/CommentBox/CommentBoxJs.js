
function Injector(options){var containerNode,currentNode,scripts=[],init=function(){options=mergeProperties(options||{},{container:document.body,sibling:null}),containerNode=options.container,currentNode=options.sibling},mergeProperties=function(e,t){var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]="undefined"==typeof e[o]?t[o]:e[o]);return n},fireLoadEvents=function(){var e;document.createEvent?(e=document.createEvent("HTMLEvents"),e.initEvent("load",!1,!0),window.dispatchEvent(e)):document.createEventObject&&(e=document.createEventObject(),document.body.fireEvent("onload",e))},documentWrite=function(e){appendHtml(e)},createTemp=function(e){var t=document.createElement("div");if("object"==typeof e&&e.parentNode)t.appendChild(e);else if("object"==typeof e&&e.length)for(;e.length;)t.appendChild(e[0]);else t.innerHTML="<span>.</span>"+e,t.removeChild(t.childNodes[0]);return t},appendHtml=function(e){var t=createTemp(e);replaceScripts(t);for(var n=t.childNodes;n.length;)appendNode(n[0])},appendNode=function(e){currentNode?currentNode.parentNode.insertBefore(e,currentNode.nextSibling):containerNode.appendChild(e),currentNode=e},replaceScripts=function(e){for(var t=e.getElementsByTagName("script"),n=t.length-1;n>=0;n--)!function(){var e=t[n],o=document.createComment("Script placeholder");e.parentNode.insertBefore(o,e),e.parentNode.removeChild(e),scripts.unshift({placeholder:o,node:e})}()},restoreScripts=function(e,t){var n=function(){if(e.length){var o=e.shift();if(currentNode=o.placeholder,o.node.src){var i=document.createElement("script");i.type="text/javascript",i.src=o.node.src,addScriptListeners(i,n),o.placeholder.parentNode.insertBefore(i,o.placeholder)}else o.node.innerHTML?(evalInline(o.node.innerHTML),n()):n()}else t()};n()},addScriptListeners=function(e,t){if(e.addEventListener)e.addEventListener("error",t,!0),e.addEventListener("load",t,!0);else{if(!e.attachEvent)throw Error("Failed to attach listeners to script.");e.attachEvent("onerror",t,!0),e.attachEvent("onload",t,!0),e.attachEvent("onreadystatechange",function(){("complete"==e.readyState||"loaded"==e.readyState)&&t()})}},evalInline=function(script){try{eval(script)}catch(e){}},expose=function(e){return function(){var t=this,n=document.write;document.write=documentWrite,e.apply(this,arguments),restoreScripts(scripts,function(){document.write=n,t.oncomplete.call()})}};this.oncomplete=function(){},this.eval=expose(function(e){evalInline(e)}),this.insert=expose(function(e){appendHtml(e)}),this.setContainer=function(e){e&&(containerNode=e)},this.setSibling=function(e){e&&(currentNode=e,containerNode=e.parentNode)},init()}!function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var n,o=e(document);e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,o){var i=e.Event(n);return t.trigger(i,o),i.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(o){var i,s,r,a,c,l,u,p;if(n.fire(o,"ajax:before")){if(a=o.data("cross-domain"),c=a===t?null:a,l=o.data("with-credentials")||null,u=o.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,o.is("form")){i=o.attr("method"),s=o.attr("action"),r=o.serializeArray();var d=o.data("ujs:submit-button");d&&(r.push(d),o.data("ujs:submit-button",null))}else o.is(n.inputChangeSelector)?(i=o.data("method"),s=o.data("url"),r=o.serialize(),o.data("params")&&(r=r+"&"+o.data("params"))):o.is(n.buttonClickSelector)?(i=o.data("method")||"get",s=o.data("url"),r=o.serialize(),o.data("params")&&(r=r+"&"+o.data("params"))):(i=o.data("method"),s=n.href(o),r=o.data("params")||null);p={type:i||"GET",data:r,dataType:u,beforeSend:function(e,i){return i.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+i.accepts.script),n.fire(o,"ajax:beforeSend",[e,i])},success:function(e,t,n){o.trigger("ajax:success",[e,t,n])},complete:function(e,t){o.trigger("ajax:complete",[e,t])},error:function(e,t,n){o.trigger("ajax:error",[e,t,n])},crossDomain:c},l&&(p.xhrFields={withCredentials:l}),s&&(p.url=s);var h=n.ajax(p);return o.trigger("ajax:send",h),h}return!1},handleMethod:function(o...|a.result(this.collection,"url")||P();return this.isNew()?e:e+("/"===e.charAt(e.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(e){return!this.validate||!this.validate(this.attributes,e)},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=a.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,t||{}),!1):!0}});var h=e.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,a.extend({silent:!0},t))};a.extend(h.prototype,p,{model:d,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return e.sync.apply(this,arguments)},add:function(e,t){e=a.isArray(e)?e.slice():[e],t||(t={});var n,o,s,c,l,u,p,d,h,m;for(p=[],d=t.at,h=this.comparator&&null==d&&0!=t.sort,m=a.isString(this.comparator)?this.comparator:null,n=0,o=e.length;o>n;n++)(s=this._prepareModel(c=e[n],t))?(l=this.get(s))?t.merge&&(l.set(c===s?s.attributes:c,t),h&&!u&&l.hasChanged(m)&&(u=!0)):(p.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)):this.trigger("invalid",this,c,t);if(p.length&&(h&&(u=!0),this.length+=p.length,null!=d?r.apply(this.models,[d,0].concat(p)):i.apply(this.models,p)),u&&this.sort({silent:!0}),t.silent)return this;for(n=0,o=p.length;o>n;n++)(s=p[n]).trigger("add",s,this,t);return u&&this.trigger("sort",this,t),this},remove:function(e,t){e=a.isArray(e)?e.slice():[e],t||(t={});var n,o,i,s;for(n=0,o=e.length;o>n;n++)s=this.get(e[n]),s&&(delete this._byId[s.id],delete this._byId[s.cid],i=this.indexOf(s),this.models.splice(i,1),this.length--,t.silent||(t.index=i,s.trigger("remove",s,this,t)),this._removeReference(s));return this},push:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:this.length},t)),e},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return e=this._prepareModel(e,t),this.add(e,a.extend({at:0},t)),e},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(e,t){return this.models.slice(e,t)},get:function(e){return null==e?void 0:(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[e.id||e.cid||e[this._idAttr]||e])},at:function(e){return this.models[e]},where:function(e){return a.isEmpty(e)?[]:this.filter(function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),a.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(a.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return a.invoke(this.models,"get",e)},update:function(e,t){t=a.extend({add:!0,merge:!0,remove:!0},t),t.parse&&(e=this.parse(e,t));var n,o,i,s,r=[],c=[],l={};if(a.isArray(e)||(e=e?[e]:[]),t.add&&!t.remove)return this.add(e,t);for(o=0,i=e.length;i>o;o++)n=e[o],s=this.get(n),t.remove&&s&&(l[s.cid]=!0),(t.add&&!s||t.merge&&s)&&r.push(n);if(t.remove)for(o=0,i=this.models.length;i>o;o++)n=this.models[o],l[n.cid]||c.push(n);return c.length&&this.remove(c,t),r.length&&this.add(r,t),this},reset:function(e,t){t||(t={}),t.parse&&(e=this.parse(e,t));for(var n=0,o=this.models.length;o>n;n++)this._removeReference(this.models[n]);return t.previousModels=this.models.slice(),this._reset(),e&&this.add(e,a.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),this},fetch:function(e){e=e?a.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success;return e.success=function(e,n,o){var i=o.update?"update":"reset";e[i](n,o),t&&t(e,n,o)},this.sync("read",this,e)},create:function(e,t){if(t=t?a.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var n=this,o=t.success;return t.success=function(e,t,i){i.wait&&n.add(e,i),o&&o(e,t,i)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(e,t){if(e instanceof d)return e.collection||(e.collection=this),e;t||(t={}),t.collection=this;var n=new this.model(e,t);return n._validate(e,t)?n:!1},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,o){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,o),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))},sortedIndex:function(e,t,n){t||(t=this.comparator);var o=a.isFunction(t)?t:function(e){return e.get(t)};return a.sortedIndex(this.models,e,o,n)
}});var m=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];a.each(m,function(e){h.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),a[e].apply(a,t)}});var f=["groupBy","countBy","sortBy"];a.each(f,function(e){h.prototype[e]=function(t,n){var o=a.isFunction(t)?t:function(e){return e.get(t)};return a[e](this.models,o,n)}});var g=e.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},_=/\((.*?)\)/g,v=/(\(\?)?:\w+/g,y=/\*\w+/g,w=/[\-{}\[\]+?.,\\\^$|#\s]/g;a.extend(g.prototype,p,{initialize:function(){},route:function(t,n,o){return a.isRegExp(t)||(t=this._routeToRegExp(t)),o||(o=this[n]),e.history.route(t,a.bind(function(i){var s=this._extractParameters(t,i);o&&o.apply(this,s),this.trigger.apply(this,["route:"+n].concat(s)),this.trigger("route",n,s),e.history.trigger("route",this,n,s)},this)),this},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes)for(var e,t=a.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])},_routeToRegExp:function(e){return e=e.replace(w,"\\$&").replace(_,"(?:$1)?").replace(v,function(e,t){return t?e:"([^/]+)"}).replace(y,"(.*?)"),new RegExp("^"+e+"$")},_extractParameters:function(e,t){return e.exec(t).slice(1)}});var b=e.History=function(){this.handlers=[],a.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},k=/^[#\/]|\s+$/g,V=/^\/+|\/+$/g,C=/msie [\w.]+/,S=/\/$/;b.started=!1,a.extend(b.prototype,p,{interval:50,getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=this.location.pathname;var n=this.root.replace(S,"");e.indexOf(n)||(e=e.substr(n.length))}else e=this.getHash();return e.replace(k,"")},start:function(t){if(b.started)throw new Error("Backbone.history has already been started");b.started=!0,this.options=a.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),o=document.documentMode,i=C.exec(navigator.userAgent.toLowerCase())&&(!o||7>=o);this.root=("/"+this.root+"/").replace(V,"/"),i&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!i?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var s=this.location,r=s.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!r?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&r&&s.hash&&(this.fragment=this.getHash().replace(k,""),this.history.replaceState({},document.title,this.root+this.fragment+s.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),b.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),this.loadUrl()||this.loadUrl(this.getHash()),void 0)},loadUrl:function(e){var t=this.fragment=this.getFragment(e),n=a.any(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0});return n},navigate:function(e,t){if(!b.started)return!1;if(t&&t!==!0||(t={trigger:t}),e=this.getFragment(e||""),this.fragment!==e){this.fragment=e;var n=this.root+e;if(this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}t.trigger&&this.loadUrl(e)}},_updateHash:function(e,t,n){if(n){var o=e.href.replace(/(javascript:|#).*$/,"");e.replace(o+"#"+t)}else e.hash="#"+t}}),e.history=new b;var M=e.View=function(e){this.cid=a.uniqueId("view"),this._configure(e||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.de...עות פייסבוק",comment_see_more:" לחץ כאן כדי לראות עוד %s תגובות %s",comment_replies:"תגובות",comment_expand:"הגב",comment_collapse:"מזער",comment_votes:"הצבעות",comment_your_opinion:"מה דעתך על תגובה זו?",comment_flag_spam:"דווח",comment_stats:"סטטיסטיקה",comment_delete:"מחק",comment_share_facebook:"שתף בפייסבוק",comment_close_stats:"סגור",comment_posted_a_comment:"פרסם תגובה ב-",comment_continue:"קרא עוד",comment_display_length:"120",emotion_name_All:"הכל",emotion_name_intellectual:"תומך",emotion_name_worrisome:"מדאיג",emotion_name_funny:"מצחיק",emotion_name_question:"ניטרלי",emotion_name_angry:"מכעיס",emotion_plural_name_All:"הכל",emotion_plural_name_Intellectual:"תומכות",emotion_plural_name_Worrisome:"מדאיגות",emotion_plural_name_Funny:"מצחיקות",emotion_plural_name_Question:"ניטרליות",emotion_plural_name_Maddening:"מכעיסות",emotion_commenters_All:"הכל",emotion_commenters_Intellectual:"תומכים",emotion_commenters_Worrisome:"מודאגים",emotion_commenters_Funny:"מצחיקים",emotion_commenters_Question:"ניטרלים",emotion_commenters_Maddening:"כועסים",add_comment_post_as:"שלח כ...",add_comment_post_as_altr:"שלח",add_comment_add_new:"הוסף תגובה",add_comment_name:"שם",add_comment_location:"עיר",add_comment_send_as:"שלח כאנונימי",add_comment_vg_credits:"קרדיטים",add_comment_share:"שתף",add_comment_or:"או",add_comment_register:'הרשם באמצעות דוא"ל',times_second:"שניה",times_minute:"דקה",times_hour:"שעה",times_day:"יום",times_week:"שבוע",times_month:"חודש",times_year:"שנה",times_decade:"עשור",times_second_mul:"שניות",times_minute_mul:"דקות",times_hour_mul:"שעות",times_day_mul:"ימים",times_week_mul:"שבועות",times_month_mul:"חודשים",times_year_mul:"שנים",times_decade_mul:"עשורים",times_ago:"לפני",times_from_now:"עוד",times_times_position:"before",users_list_commenters:"%s מגיבים",users_list_all_commenters:"כל המגיבים",users_list_empty_prefix:"אין",profile_back_to_comments:"חזרה לתגובות",profile_activity_tab:"פעילות",profile_no_following:"אין נעקבים",profile_no_followers:"אין עוקבים",filter_comments_by_category_title:"סנן",auth_email_field_name:"אימייל",auth_password_field_name:"סיסמא",auth_password_confirmation_field_name:"אישור סיסמא",auth_agree_terms_of_use:"",auth_terms_of_use:"בלחיצה על כפתור הרשם אתה מסכים לתנאי השימוש",auth_privacy_policy:"ולתנאי הפרטיות",auth_sign_up:"הרשם",auth_sign_in:"התחבר",auth_fb_sign_up:"או הירשם עם פייסבוק",auth_fb_sign_in:"או התחבר עם פייסבוק",auth_enter_user_info:"אנא הכנס מידע עליך",auth_first_name:"שם פרטי",auth_last_name:"שם משפחה",auth_user_name:"שם משתמש",auth_city:"עיר",auth_company_name:"מקום עבודה ",auth_gender:"מין",auth_male:"זכר",auth_female:"נקבה",auth_email:"דואל",auth_phone:"טלפון",auth_about:"עליי",auth_password:"סיסמה",auth_old_password:"סיסמה ישנה",auth_new_password:"סיסמה חדשה",auth_confirm_password:"אשר סיסמה",auth_about_you:"עליך",auth_photos:"תמונות",auth_profile:"פרופיל",auth_cover_photo:"תמונת רקע",auth_click_to_change:"לחץ כדי לשנות",auth_change_password:"שנה סיסמה",auth_finish:"סיים",auth_no_thanks:"לא תודה",auth_terms_seperator:" ",auth_reset_password_title:"שחזור סיסמא",auth_reset_password_subtitle:"הכנס את כתובת המייל שלך ואנו נשלח לך קישור לאיפוס הסיסמא",auth_reset_password_success:"המייל נשלח בהצלחה!",auth_reset_password_send:"שלח",auth_reset_password_change:"אישור",auth_reset_password_change_subtitle:"הכנס סיסמא חדשה",auth_reset_password_change_success:"הסיסמא שונתה בהצלחה!",auth_reset_password_email_direction:"rtl",auth_reset_password_email_dear_user:"משתמש יקר,",auth_reset_password_email_title:"שינוי סיסמה עבור:",auth_reset_password_email_link:"%s לשינוי הסיסמה",auth_reset_password_email_click_here:"לחץ כאן",auth_reset_password_email_follow_link:"או העתק הדבק את הכתובת הבאה:",auth_reset_password_email_thanks:"תודה,<br>צוות Vicomi",default_user_name:"אורח",default_user_location:"פה ושם",message_empty_comment:"אנא מלא את תוכן התגובה",message_category_not_selected:"יש לבחור קטגוריה",message_add_comment_success:"התגובה התקבלה ותפורסם בהתאם לשיקולי המערכת.",message_vote_success:"הצבעתך התקבלה",message_flag_success:"הדיווח התקבל",message_empty_email:"הכנס כתובת אימייל",message_wrong_email:"הכנס כתובת אימייל תקינה",message_empty_username:"הכנס שם משתמש",message_empty_password:"הכנס סיסמה",message_password_doesnt_match_confirm:"הסיסמא אינה תואמת את אישור הסיסמא",message_delete_comment_success:"התגובה נמחקה בהצלחה",message_delete_comment_failed:"מחיקת ההודעה נכשלה",message_login_failed:"התחברות נכשלה! שם משתמש או סיסמא שגויים",message_signup_success:"ההרשמה בוצעה בהצלחה! בדוק את תיבת הדואר שלך לאישור הפרטים וסיום ההרשמה.",modal_delete_confirm_title:"מחיקת תגובה",modal_delete_confirm_message:"האם אתה בטוח שברצונך למחוק את התגובה?",modal_delete_confirm_delete:"מחק",modal_delete_confirm_cancel:"ביטול",recommend_title:"תגובות שעשויות לעניין אותך",recommend_ad_tag:"מרחבי הרשת",date_filter_newest:"חדש",date_filter_oldest:"ישן",date_filter_popular:"פופולארי",date_filter_personalized:"מותאם אישית"}},function(e){function t(e,t){return function(n){return c(e.call(this,n),t)
}}function n(e){return function(t){return this.lang().ordinal(e.call(this,t))}}function o(){}function i(e){r(this,e)}function s(e){var t=this._data={},n=e.years||e.year||e.y||0,o=e.months||e.month||e.M||0,i=e.weeks||e.week||e.w||0,s=e.days||e.day||e.d||0,r=e.hours||e.hour||e.h||0,c=e.minutes||e.minute||e.m||0,l=e.seconds||e.second||e.s||0,u=e.milliseconds||e.millisecond||e.ms||0;this._milliseconds=u+1e3*l+6e4*c+36e5*r,this._days=s+7*i,this._months=o+12*n,t.milliseconds=u%1e3,l+=a(u/1e3),t.seconds=l%60,c+=a(l/60),t.minutes=c%60,r+=a(c/60),t.hours=r%24,s+=a(r/24),s+=7*i,t.days=s%30,o+=a(s/30),t.months=o%12,n+=a(o/12),t.years=n}function r(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function a(e){return 0>e?Math.ceil(e):Math.floor(e)}function c(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function l(e,t,n){var o,i=t._milliseconds,s=t._days,r=t._months;i&&e._d.setTime(+e+i*n),s&&e.date(e.date()+s*n),r&&(o=e.date(),e.date(1).month(e.month()+r*n).date(Math.min(o,e.daysInMonth())))}function u(e){return"[object Array]"===Object.prototype.toString.call(e)}function p(e,t){var n,o=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0;for(n=0;o>n;n++)~~e[n]!==~~t[n]&&s++;return s+i}function d(e,t){return t.abbr=e,E[e]||(E[e]=new o),E[e].set(t),E[e]}function h(e){return e?(!E[e]&&O&&require("./lang/"+e),E[e]):P.fn._lang}function m(e){return e.match(/\[.*\]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function f(e){var t,n,o=e.match(L);for(t=0,n=o.length;n>t;t++)o[t]=it[o[t]]?it[o[t]]:m(o[t]);return function(i){var s="";for(t=0;n>t;t++)s+="function"==typeof o[t].call?o[t].call(i,e):o[t];return s}}function g(e,t){function n(t){return e.lang().longDateFormat(t)||t}for(var o=5;o--&&N.test(t);)t=t.replace(N,n);return tt[t]||(tt[t]=f(t)),tt[t](e)}function _(e){switch(e){case"DDDD":return U;case"YYYY":return B;case"YYYYY":return J;case"S":case"SS":case"SSS":case"DDD":return Y;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return G;case"X":return q;case"Z":case"ZZ":return z;case"T":return H;case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return j;default:return new RegExp(e.replace("\\",""))}}function v(e,t,n){var o,i=n._a;switch(e){case"M":case"MM":i[1]=null==t?0:~~t-1;break;case"MMM":case"MMMM":o=h(n._l).monthsParse(t),null!=o?i[1]=o:n._isValid=!1;break;case"D":case"DD":case"DDD":case"DDDD":null!=t&&(i[2]=~~t);break;case"YY":i[0]=~~t+(~~t>68?1900:2e3);break;case"YYYY":case"YYYYY":i[0]=~~t;break;case"a":case"A":n._isPm="pm"===(t+"").toLowerCase();break;case"H":case"HH":case"h":case"hh":i[3]=~~t;break;case"m":case"mm":i[4]=~~t;break;case"s":case"ss":i[5]=~~t;break;case"S":case"SS":case"SSS":i[6]=~~(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,o=(t+"").match(K),o&&o[1]&&(n._tzh=~~o[1]),o&&o[2]&&(n._tzm=~~o[2]),o&&"+"===o[0]&&(n._tzh=-n._tzh,n._tzm=-n._tzm)}null==t&&(n._isValid=!1)}function y(e){var t,n,o=[];if(!e._d){for(t=0;7>t;t++)e._a[t]=o[t]=null==e._a[t]?2===t?1:0:e._a[t];o[3]+=e._tzh||0,o[4]+=e._tzm||0,n=new Date(0),e._useUTC?(n.setUTCFullYear(o[0],o[1],o[2]),n.setUTCHours(o[3],o[4],o[5],o[6])):(n.setFullYear(o[0],o[1],o[2]),n.setHours(o[3],o[4],o[5],o[6])),e._d=n}}function w(e){var t,n,o=e._f.match(L),i=e._i;for(e._a=[],t=0;t<o.length;t++)n=(_(o[t]).exec(i)||[])[0],n&&(i=i.slice(i.indexOf(n)+n.length)),it[o[t]]&&v(o[t],n,e);e._isPm&&e._a[3]<12&&(e._a[3]+=12),e._isPm===!1&&12===e._a[3]&&(e._a[3]=0),y(e)}function b(e){for(var t,n,o,s,a=99;e._f.length;){if(t=r({},e),t._f=e._f.pop(),w(t),n=new i(t),n.isValid()){o=n;break}s=p(t._a,n.toArray()),a>s&&(a=s,o=n)}r(e,o)}function k(e){var t,n=e._i;if(W.exec(n)){for(e._f="YYYY-MM-DDT",t=0;4>t;t++)if(Z[t][1].exec(n)){e._f+=Z[t][0];break}z.exec(n)&&(e._f+=" Z"),w(e)}else e._d=new Date(n)}function V(t){var n=t._i,o=R.exec(n);n===e?t._d=new Date:o?t._d=new Date(+o[1]):"string"==typeof n?k(t):u(n)?(t._a=n.slice(0),y(t)):t._d=n instanceof Date?new Date(+n):new Date(n)}function C(e,t,n,o,i){return i.relativeTime(t||1,!!n,e,o)}function S(e,t,n){var o=F(Math.abs(e)/1e3),i=F(o/60),s=F(i/60),r=F(s/24),a=F(r/365),c=45>o&&["s",o]||1===i&&["m"]||45>i&&["mm",i]||1===s&&["h"]||22>s&&["hh",s]||1===r&&["d"]||25>=r&&["dd",r]||45>=r&&["M"]||345>r&&["MM",F(r/30)]||1===a&&["y"]||["yy",a];return c[2]=t,c[3]=e>0,c[4]=n,C.apply({},c)}function M(e,t,n){var o=n-t,i=n-e.day();return i>o&&(i-=7),o-7>i&&(i+=7),Math.ceil(P(e).add("d",i).dayOfYear()/7)}function T(e){var t=e._i,n=e._f;return null===t||""===t?null:("string"==typeof t&&(e._i=t=h().preparse(t)),P.isMoment(t)?(e=r({},t),e._d=new Date(+t._d)):n?u(n)?b(e):w(e):V(e),new i(e))}function $(e,t){P.fn[e]=P.fn[e+"s"]=function(e){var n=this._isUTC?"UTC":"";return null!=e?(this._d["set"+n+t](e),this):this._d["get"+n+t]()}}function x(e){P.duration.fn[e]=function(){return this._data[e]}}function I(e,t){P.duration.fn["as"+e]=function(){return+this/t}}for(var P,D,A="2.0.0",F=Math.round,E={},O="u..._success"))),n.push('</div>\n <a href="#" class="vc-add-comment-success-close"></a>\n </div>\n')}).call(this)}.call(e),e.safe=i,e.escape=s,n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["comments/add_altr"]=function(e){e||(e={});var t,n=[],o=function(e){return e&&e.ecoSafe?e:"undefined"!=typeof e&&null!=e?s(e):""},i=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;("undefined"==typeof e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,i,s;for(n.push(' <div class="add-comment-first-select">\n <div class="add-comment-first-select-title">Tell Us How Do You Feel?</div>\n <div class="add-comment-categories-list">\n <ul>\n '),s=this.data.categories,t=0,i=s.length;i>t;t++)e=s[t],n.push("\n "),"-1"!==e.id&&(n.push('\n <li>\n <a href="'),n.push(o(e.id)),n.push('" class="add-comment-category-btn">\n <img src="'),n.push(o(e.small_image)),n.push('" />\n <span class="add-comment-category-name">'),n.push(o(I18n.t("emotion_name_"+e.name))),n.push("</span>\n </a>\n </li>\n ")),n.push("\n ");n.push('\n </ul>\n </div>\n </div>\n\n <div class="add-comment-user">\n <img id="user-img" src="'),n.push(o(this.data.picture)),n.push('" />\n </div>\n\n <div class="add-comment-form">\n <span class="add-comment-content">\n <span class="content-triangle"></span>\n\n\n\n <textarea disabled type="text" id="add-comment-content-input" class="add-comment-content-input" name="add-comment-content-input" placeholder="'),n.push(o(I18n.t("add_comment_add_new"))),n.push('"></textarea>\n <div class="add-comment-content-footer">\n '),this.data.loggedIn&&(n.push('\n <span class="vc-checkbox anonymous-checkbox">\n <span class="icon"></span>\n <span class="text">'),n.push(o(I18n.t("add_comment_send_as"))),n.push("</span>\n </span>\n ")),n.push('\n <div class="social">\n <span class="label">'),n.push(o(I18n.t("add_comment_share"))),n.push('</span>\n <a href="#" class="social-link facebook"></a>\n <!--<a href="#" class="social-link twitter"></a>\n <a href="#" class="social-link linkedin"></a>-->\n </div>\n </div>\n </span>\n\n <div class="add-comment-anonymous-form">\n <input type="text" id="post-form-name" class="post-form-name" name="post-form-name" placeholder="'),n.push(o(I18n.t("add_comment_name"))),n.push('" value="'),n.push(o(this.data.username)),n.push('" maxlength="30"/>\n <input type="text" id="post-form-location" class="post-form-location" name="post-form-location" placeholder="'),n.push(o(I18n.t("add_comment_location"))),n.push('" value="'),n.push(o(this.data.location)),n.push('" maxlength="30"/>\n </div>\n\n <div class="post-container">\n <a href="#" class="post-btn"><span class="post-btn-text">'),n.push(o(I18n.t("add_comment_post_as_altr"))),n.push('</span><span class="arrow"></span><span class="vc-loading"></span></a>\n </div>\n </div>\n\n <!--<div class="add-comment-as-anonymous">\n <span class="add-comment-section-seperator"></span>\n '),this.data.loggedIn&&(n.push('\n <span class="vc-checkbox anonymous-checkbox selected">\n <span class="icon"></span>\n <span class="text">'),n.push(o(I18n.t("add_comment_send_as"))),n.push('"<b>'),n.push(o(this.data.username)),n.push('</b>"</span>\n </span>\n ')),n.push('\n <div class="social">\n <span class="label">'),n.push(o(I18n.t("add_comment_share"))),n.push('</span>\n <a href="#" class="social-link facebook"></a>\n <a href="#" class="social-link twitter"></a>\n <a href="#" class="social-link linkedin"></a>\n </div>\n </div>-->\n\n '),this.data.loggedIn||(n.push('\n <div class="add-comment-login">\n <span class="add-comment-section-seperator"></span>\n <a href="#" class="add-comment-login-btn">'),n.push(o(I18n.t("add_comment_register"))),n.push("</a>\n <span>"),n.push(o(I18n.t("add_comment_or"))),n.push('</span>\n <a href="#" class="add-comment-fb-login-btn"></a>\n </div>\n ')),n.push('\n\n <div class="vc-add-comment-success">\n <div class="vc-add-comment-success-icon"></div>\n <div class="vc-add-comment-success-text">'),n.push(o(I18n.t("message_add_comment_success"))),n.push('</div>\n <a href="#" class="vc-add-comment-success-close"></a>\n </div>\n')
}).call(this)}.call(e),e.safe=i,e.escape=s,n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["comments/comment"]=function(e){e||(e={});var t,n=[],o=function(e){return e&&e.ecoSafe?e:"undefined"!=typeof e&&null!=e?s(e):""},i=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;("undefined"==typeof e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){var e,t,i;n.push('<div class="vc-comment '),this.commentViewModel.comment.is_reply&&n.push(" vc-reply "),n.push('"\n data-comment-id="'),n.push(o(this.commentViewModel.comment.comment_id)),n.push('" data-owner-id="'),n.push(o(this.commentViewModel.comment.owner_id)),n.push('"\n data-item-id="'),n.push(o(this.commentViewModel.comment.item_id)),n.push('" data-comment-format="'),n.push(o(this.commentViewModel.comment.format)),n.push('">\n <!-- Comment -->\n <div class="vc-comment-inner shadow '),this.commentViewModel.comment.is_reply&&n.push("opened"),n.push(" "),n.push(o(this.commentViewModel.comment.item_virtual_good)),n.push(" "),n.push(o(this.commentViewModel.comment.format)),n.push(" "),this.commentViewModel.comment.is_anonymous_view&&n.push(" anonymous "),n.push('">\n\n <div class="vc-comment-emotion" style="background-color: '),n.push(o(this.commentViewModel.comment.category.background_color)),n.push("; border-color: "),n.push(o(this.commentViewModel.comment.category.border_color)),n.push('">\n <div class="comment-emotion-face-back" style="background-position:'),n.push(o(this.commentViewModel.comment.category.back_pos)),n.push('">\n <a href="'),n.push(o(this.commentViewModel.comment.category.id)),n.push('" class="comment-emotion-face-link filter-category-link">\n <img id="emotion-img" src="'),n.push(o(this.commentViewModel.comment.category.large_image)),n.push('"\n title="'),n.push(o(this.commentViewModel.comment.category.name)),n.push('"/>\n </a>\n </div>\n </div>\n\n <div class="vc-comment-body">\n '),this.commentViewModel.comment.is_default_format?(n.push('\n <div class="vc-comment-user-avatar">\n <img id="user-img" src="'),n.push(o(this.commentViewModel.comment.author.picture)),n.push('" />\n </div>\n <div class="vc-comment-user" >\n '),this.commentViewModel.comment.author.is_anonymous?(n.push('\n <span class="comment-user-name">'),n.push(o(this.commentViewModel.comment.author.name)),n.push("</span>\n ")):(n.push('\n <a class="comment-user-name vc-profile-link" href="'),n.push(o(this.commentViewModel.comment.author._id)),n.push('">'),n.push(o(this.commentViewModel.comment.author.name)),n.push("</a>\n ")),n.push('\n <span class="comment-user-seperator">•</span>\n <span class="comment-user-city">'),n.push(o(this.commentViewModel.comment.author.location)),n.push("</span>\n </div>\n ")):(n.push("\n "),"activity_comment"===this.commentViewModel.comment.format&&(n.push('\n <div class="vc-comment-user-avatar">\n <img id="user-img" src="'),n.push(o(this.commentViewModel.comment.author.picture)),n.push('" />\n </div>\n <div class="vc-comment-user">\n '),this.commentViewModel.comment.author.is_anonymous?(n.push('\n <span class="comment-user-name">'),n.push(o(this.commentViewModel.comment.author.name)),n.push("</span>\n ")):(n.push('\n <a class="comment-user-name vc-profile-link" href="'),n.push(o(this.commentViewModel.comment.author._id)),n.push('">'),n.push(o(this.commentViewModel.comment.author.name)),n.push("</a>\n ")),n.push("\n </div>\n ")),n.push('\n <div class="vc-comment-source">\n '),n.push(o(I18n.t("comment_posted_a_comment"))),n.push('\n <a href="'),n.push(o(this.commentViewModel.comment.discussion.source.url)),n.push('" class="comment-source-name" target="_top">'),n.push(o(this.commentViewModel.comment.discussion.source.display_name)),n.push('</a>\n | \n <a href="'),n.push(o(this.commentViewModel.comment.discussion.url)),n.push('" class="comment-source-item-title" target="_top">'),n.push(o(this.commentViewModel.comment.discussion.title)),n.push("</a>\n </div>\n ")),n.push('\n\n <div class="vc-comment-content">\n <div class="comment-content-text summery-content">\n <b>'),n.push(o(this.commentViewModel.comment.title)),n.push(" </b>\n "),n.push(o(this.commentViewModel.comment.display_content)),n.push("\n "),this.commentViewModel.comment.is_display_content_dif&&(n.push('<span clas...)),n.push('</a>\n <span class="follow-user-seperator">•</span>\n <span class="follow-user-city">'),n.push(o(this.userViewModel.user.location)),n.push('</span>\n </div>\n <div class="follow-user-info">\n <span class="follow-user-info-item"><span class="value">'),n.push(o(this.userViewModel.user.comments_count)),n.push("</span> "),n.push(o(I18n.t("comments"))),n.push('</span>\n <span class="follow-user-seperator">•</span>\n <span class="follow-user-info-item"><span class="value">'),n.push(o(this.userViewModel.user.followers_count)),n.push("</span> "),n.push(o(I18n.t("followers"))),n.push('</span>\n <span class="follow-user-seperator">•</span>\n <span class="follow-user-info-item"><span class="value">'),n.push(o(this.userViewModel.user.following_count)),n.push("</span> "),n.push(o(I18n.t("following"))),n.push("</span>\n </div>\n "),this.userViewModel.show_following&&(n.push('\n <a href="#" class="follow-btn'),this.userViewModel.is_following&&n.push(" following "),n.push('"></a>\n ')),n.push("\n</div>\n")}).call(this)}.call(e),e.safe=i,e.escape=s,n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["profile/friend_collection"]=function(e){e||(e={});var t,n=[],o=e.safe,i=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;("undefined"==typeof e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},i||(i=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){}).call(this)}.call(e),e.safe=o,e.escape=i,n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["profile/profile"]=function(e){e||(e={});var t,n=[],o=function(e){return e&&e.ecoSafe?e:"undefined"!=typeof e&&null!=e?s(e):""},i=e.safe,s=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;("undefined"==typeof e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},s||(s=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){n.push('<div class="vc-user-profile" data-user-profile-id="'),n.push(o(this.profileViewModel.user.id)),n.push('">\n <div class="vc-user-profile-cover-photo">\n <!--<img src="'),n.push(o(this.profileViewModel.user.cover_photo)),n.push('" />-->\n </div>\n <div class="vc-user-profile-details box">\n <div class="vc-responsive-menu btn btn-navbar"></div>\n <div class="vc-user-profile-avatar">\n <img class="profile-img" src="'),n.push(o(this.profileViewModel.user.picture)),n.push('" />\n <span class="user-rank '),n.push(o(this.profileViewModel.user.rank)),n.push('"></span>\n </div>\n\n <div class="vc-user-profile-name">'),n.push(o(this.profileViewModel.user.name)),n.push('</div>\n <span class="user-details-seperator">•</span>\n <div class="vc-user-profile-city">'),n.push(o(this.profileViewModel.user.location)),n.push('</div>\n </div>\n <div class="vc-user-profile-info">\n <a id="profile-comments-tab" href="profile_comments" class="info-item"><span class="value">'),n.push(o(this.profileViewModel.user.comments_count)),n.push("</span> "),n.push(o(I18n.t("comments"))),n.push("</a>\n "),this.profileViewModel.show_activity&&(n.push(' <a id="profile-feed-tab" href="profile_feed" class="info-item">'),n.push(o(I18n.t("profile_activity_tab"))),n.push("</a>")),n.push('\n <a id="profile-followers-tab" href="profile_followers" class="info-item middle"><span class="value">'),n.push(o(this.profileViewModel.user.followers_count)),n.push("</span> "),n.push(o(I18n.t("followers"))),n.push('</a>\n <a id="profile-following-tab" href="profile_following" class="info-item"><span class="value">'),n.push(o(this.profileViewModel.user.following_count)),n.push("</span> "),n.push(o(I18n.t("following"))),n.push("</a>\n "),this.profileViewModel.show_following&&(n.push('\n <a href="#" class="follow-btn'),this.profileViewModel.is_following&&n.push(" following "),n.push('"></a>\n ')),n.push('\n </div>\n <div class="vc-user-profile-content">\n\n </div>\n</div>\n\n<script>\n $(function() {\n\n\n\n });\n</script>\n')}).call(this)}.call(e),e.safe=i,e.escape=s,n.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["profile/profile_tab"]=function(e){e||(e={});var t,n=[],o=e.safe,i=e.escape;return t=e.safe=function(e){if(e&&e.ecoSafe)return e;("undefined"==typeof e||null==e)&&(e="");var t=new String(e);return t.ecoSafe=!0,t},i||(i=e.escape=function(e){return(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}),function(){(function(){}).call(this)}.call(e),e.safe=o,e.escape=i,n.join("")}}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Models.Author=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)
}return n(o,t),o.prototype.defaults=function(){return{name:I18n.t("default_user_name"),location:I18n.t("default_user_location"),picture:"http://d13ugwqhob2bdy.cloudfront.net/assets/user.png",is_anonymous:!0}},o.prototype.initialize=function(){return this.get("name")&&""!==this.get("name")||this.set({name:this.defaults().name}),this.get("location")&&""!==this.get("location")||this.set({location:this.defaults().location}),this.get("picture")&&""!==this.get("picture")?void 0:this.set({picture:this.defaults().picture})},o}(Backbone.Model)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Models.Comment=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.defaults=function(){},o.prototype.initialize=function(e){return this.set("author",new Vicomi.Models.Author(e.author)),e.discussion?this.set("discussion",new Vicomi.Models.CommentDiscussion(e.discussion)):void 0},o}(Backbone.Model)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Models.CommentDiscussion=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.defaults=function(){},o.prototype.initialize=function(e){return e.source?this.set("source",new Vicomi.Models.Source(e.source)):void 0},o}(Backbone.Model)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Models.Discussion=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.urlRoot="/api/v1/discussions/",o.prototype.idAttribute="id",o.prototype.url=function(){var e,t,n,o,i;return this.isNew()?(o=""!==this.get("image")?"&image="+this.get("image"):"",t=""!==this.get("description")?"&description="+this.get("description"):"",n=""!==this.get("externalid")?"&externalid="+this.get("externalid"):"",e=""!==this.get("authorid")?"&authorid="+this.get("authorid"):"",i=""!==this.get("tags")?"&tags="+this.get("tags"):"",this.urlRoot+"init?url="+this.get("discussion_url")+"&title="+this.get("title")+i+e+o+t+n+"&access_token="+this.get("access_token")):this.urlRoot+this.id},o.prototype.defaults=function(){return{discussion_url:"Empty Url",title:"Empty Title"}},o.prototype.initialize=function(){return this.get("discussion_url")||this.set({discussion_url:this.defaults().discussion_url}),this.get("title")||this.set({title:this.defaults().title}),this.fetch()},o}(Backbone.Model)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Models.FlagComment=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.urlRoot="/api/v1/comments/",o.prototype.url=function(){return this.urlRoot+this.id+"/flag?access_token="+Vicomi.Globals.discussion.get("access_token")},o.prototype.initialize=function(e){return this.set("author",new Vicomi.Models.Author(e.author)),e.discussion?this.set("discussion",new Vicomi.Models.CommentDiscussion(e.discussion)):void 0},o}(Backbone.Model)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Models.Friend=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.defaults=function(){return{name:"Unknown",city:"Earth",_picture:"http://d13ugwqhob2bdy.cloudfront.net/assets/user.png"}},o.prototype.initialize=function(){return this.get("picture")&&""!==this.get("picture")?void 0:this.set({picture:this.defaults()._picture})},o}(Backbone.Model)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Models.Pager=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.idAttribute="id",o.prototype.defaults=function(){return{id:-1}},o}(Backbone.Model)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Models.Profile=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.urlRoot="/api/v1/users/",o.prototype.url=fun...=JST["layout/category_filter"],o.prototype.tagName="div",o.prototype.className="categories header-categories",o.prototype.events={"click .category-select-btn":"onOpenClick","click .filter-category-btn":"onCategorySelected","mouseleave .category-select-container":"onMouseLeave"},o.prototype.initialize=function(e){return this.categories=e.categories,this.pagerModel=e.pagerModel,this.selectedCategory=this.categories[0]},o.prototype.render=function(){return $(this.el).html(this.template({viewModel:this.prepareModelForView()})),this.renderSelectedCategory(),this.delegateEvents(),this},o.prototype.renderSelectedCategory=function(){return this.$(".category-select-btn").children("img").attr("src",this.selectedCategory.small_image),this.$(".category-select-btn").children(".emotion-name").text(I18n.t("emotion_name_"+this.selectedCategory.name))},o.prototype.prepareModelForView=function(){var e;return e={selected_category:this.selectedCategory,categories:this.categories}},o.prototype.onCategorySelected=function(e){var t;return e.preventDefault(),this.$(".category-select-container").removeClass("opened"),t=$(e.currentTarget).parent().attr("data-category-id"),this.changeSelectedCategory(t)},o.prototype.changeSelectedCategory=function(e){return this.selectedCategory=_.find(this.categories,function(t){return t.id===e}),this.renderSelectedCategory(),this.pagerModel.set("selectedCategory",e)},o.prototype.onOpenClick=function(e){return e.preventDefault(),e.stopPropagation(),this.$(".category-select-container").toggleClass("opened")},o.prototype.onMouseLeave=function(){return this.$(".category-select-container").removeClass("opened")},o}(Backbone.View)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Views.AddComment=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.template=JST["comments/add"],o.prototype.tagName="div",o.prototype.className="add-comment",o.prototype.events={"click .emotion-btn":"addComment","focus #add-comment-content-input":"onInputFocus","keyup #add-comment-content-input":"onContentKeyPress",mouseleave:"onMouseLeave","click .post-btn":"onPostClick","mouseleave .post-container":"onMouseLeavePost","click .anonymous-checkbox":"onAnonymousChBxClick","click .vc-add-comment-success-close":"onCloseSuccess","click .facebook":"onShareFBClick","click .add-comment-login-btn":"signupClick","click .add-comment-fb-login-btn":"fbLoginClick","click .add-comment-user":"toggleUserDropdown"},o.prototype.initialize=function(){return this.discussion=this.options.discussion,this.comments=this.options.comments,this.isHeader=this.options.isHeader,null!=this.options.isReply&&this.options.isReply?(this.$el.addClass("add-reply"),this.isReply=!0):void 0},o.prototype.render=function(){var e;return e=Vicomi.Globals.loggedIn?{loggedIn:!0,user_id:Vicomi.Globals.currentUser.get("id"),username:Vicomi.Globals.currentUser.get("name"),picture:Vicomi.Globals.currentUser.get("picture"),location:Vicomi.Globals.currentUser.get("city"),categories:this.discussion.get("categories")}:{loggedIn:!1,picture:"http://d13ugwqhob2bdy.cloudfront.net/assets/user.png",categories:this.discussion.get("categories"),username:"",location:""},$(this.el).html(this.template({data:e})),e.loggedIn?this.disableAnonymous():this.enableAnonymous(),$(this.el).attr("data-virtual-good-id","-1"),this.renderUserDropdown(),this.delegateEvents(),$("input, textarea").placeholder(),this},o.prototype.renderUserDropdown=function(){return this.isHeader&&Vicomi.Globals.loggedIn?(this.headerAuth=new Vicomi.Views.HeaderUser({model:Vicomi.Globals.currentUser,parentContainer:this}),$(this.el).find(".add-comment-user").after(this.headerAuth.render().el),$(this.el).find(".add-comment-user").append('<span class="add-comment-user-toggle-btn"></span>'),$(this.el).addClass("logged-in")):($(this.el).removeClass("logged-in"),$(this.el).removeClass("show-user-dropdown"))},o.prototype.addComment=function(e){var t,n,o;return e.preventDefault(),this.$(".post-container").removeClass("opened"),""===this.$("#add-comment-content-input").val()?alert(I18n.t("message_empty_comment")):(this.removeFocus(),this.$(".post-container").addClass("vc-loading"),t=this.isAnonymous()?{name:this.$("#post-form-name").val(),location:this.$("#post-form-location").val()}:{is_anonymous:!1,name:Vicomi.Globals.currentUser.get("name"),location:Vicomi.Globals.currentUser.get("city"),picture:Vicomi.Globals.currentUser.get("picture")},Vicomi.Globals.loggedIn&&(t.user=Vicomi.Globals.currentUser.get("id")),n=new Vicomi.Models.Comment({title:"",text:this.$("#add-comment-content-input").val(),author:t,posted:this.getCurrentDate(),c_id:$(e.currentTarget).attr("href"),d_id:this.discussion.id,s_id:this.discussion.get("source_id")}),o=this,this.comments.create(n,{wait:!0,success:function(){return o.onSendSuccess(n)
},error:this.handleError}))},o.prototype.handleError=function(e,t){var n,o,i,s,r;if(422===t.status){o=$.parseJSON(t.responseText).errors,r=[];for(n in o)s=o[n],r.push(function(){var e,t,o;for(o=[],e=0,t=s.length;t>e;e++)i=s[e],o.push(alert(""+n+" "+i));return o}());return r}},o.prototype.getCurrentDate=function(){return moment.utc()},o.prototype.onSendSuccess=function(e){return this.clearForm(),this.$(".post-container").removeClass("vc-loading"),this.toggleSuccessMessage(),Vicomi.Globals.discussion.get("should_moderate")||this.trigger("commentCreated",e),null!=Vicomi.Views.commentsAppview?Vicomi.Views.commentsAppview.onAddCommentsSuccess(e,this.$(".facebook").hasClass("selected")):void 0},o.prototype.clearForm=function(){return this.$("#add-comment-content-input").val(""),this.$("#post-form-location").val(""),this.$("#post-form-name").val("")},o.prototype.onCloseSuccess=function(e){return e.preventDefault(),this.toggleSuccessMessage()},o.prototype.toggleSuccessMessage=function(){return $(this.el).toggleClass("show-success")},o.prototype.onInputFocus=function(){return $(this.el).addClass("focused"),this.adjustInputHeight()},o.prototype.onMouseLeave=function(){},o.prototype.removeFocus=function(){return $(this.el).removeClass("focused"),this.$("#add-comment-content-input").removeAttr("style")},o.prototype.onPostClick=function(e){return e.preventDefault(),e.stopPropagation(),this.$(".post-container").toggleClass("opened")},o.prototype.onMouseLeavePost=function(){return this.$(".post-container").removeClass("opened")},o.prototype.onAnonymousChBxClick=function(){return this.$(".anonymous-checkbox").toggleClass("selected"),this.isAnonymous()?this.enableAnonymous():this.disableAnonymous()},o.prototype.enableAnonymous=function(){return $(this.el).find(".post-form-name").attr("disabled",!1),$(this.el).find(".post-form-location").attr("disabled",!1)},o.prototype.disableAnonymous=function(){return $(this.el).find(".post-form-name").attr("disabled",!0),$(this.el).find(".post-form-location").attr("disabled",!0)},o.prototype.show=function(){return this.$el.show()},o.prototype.hide=function(){return this.$el.hide()},o.prototype.isAnonymous=function(){return!Vicomi.Globals.loggedIn||this.$(".anonymous-checkbox").hasClass("selected")},o.prototype.onContentKeyPress=function(){return this.adjustInputHeight()},o.prototype.adjustInputHeight=function(){var e,t,n;return t=this.$("#add-comment-content-input")[0],n=parseInt($(t).css("padding-top")),e=t.scrollHeight,e-=2*n,e>$(t).height()?$(t).height(e+10):""===$(t).val()?$(t).removeAttr("style"):void 0},o.prototype.onShareFBClick=function(e){return e.preventDefault(),e.stopPropagation(),$(e.currentTarget).toggleClass("selected")},o.prototype.signupClick=function(e){return e.preventDefault(),Vicomi.Routers.AuthenticationRouter.navigate("/signup",{trigger:!0})},o.prototype.fbLoginClick=function(e){return e.preventDefault(),Vicomi.Routers.AuthenticationRouter.fbLogin()},o.prototype.toggleUserDropdown=function(){return this.isHeader&&Vicomi.Globals.loggedIn?$(this.el).toggleClass("show-user-dropdown"):void 0},o}(Backbone.View)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Views.AddCommentAltr=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.template=JST["comments/add_altr"],o.prototype.tagName="div",o.prototype.className="add-comment add-comment-altr",o.prototype.events={"click .add-comment-category-btn":"selectCategory","focus #add-comment-content-input":"onInputFocus","keyup #add-comment-content-input":"onContentKeyPress",mouseleave:"onMouseLeave","click .post-btn":"addComment","mouseleave .post-container":"onMouseLeavePost","click .anonymous-checkbox":"onAnonymousChBxClick","click .vc-add-comment-success-close":"onCloseSuccess","click .facebook":"onShareFBClick","click .add-comment-login-btn":"signupClick","click .add-comment-fb-login-btn":"fbLoginClick","click .add-comment-user":"toggleUserDropdown"},o.prototype.initialize=function(){return this.discussion=this.options.discussion,this.comments=this.options.comments,this.isHeader=this.options.isHeader,null!=this.options.isReply&&this.options.isReply?(this.$el.addClass("add-reply"),this.isReply=!0):void 0},o.prototype.render=function(){var e;return e=Vicomi.Globals.loggedIn?{loggedIn:!0,user_id:Vicomi.Globals.currentUser.get("id"),username:Vicomi.Globals.currentUser.get("name"),picture:Vicomi.Globals.currentUser.get("picture"),location:Vicomi.Globals.currentUser.get("city"),categories:this.discussion.get("categories")}:{loggedIn:!1,picture:"http://d13ugwqhob2bdy.cloudfront.net/assets/user.png",categories:this.discussion.get("categories"),username:"",location:""},$(this.el).html(this.template({data:e})),e.loggedIn?this.disableAnonymous():this.enableAnonymous(),$(this.el).attr("data-virtual-good-id","-1"),t..."change:currentPage")},o.prototype.updateCommentsCount=function(){return $(this.el).children(".vc-comments-header").children(".num").children(".value").html(Vicomi.Globals.discussion.get("num_comments")),$(this.el).children(".no-comments-message").length>0?$(this.el).children(".no-comments-message").remove():void 0},o.prototype.setLoading=function(){return this.pagerView.setLoading(),$(this.el).addClass("vc-loading")},o.prototype.removeLoading=function(){return $(this.el).removeClass("vc-loading"),this.pagerView.removeLoading()},o.prototype.statsClicked=function(){return this.$statsBtn.toggleClass("opened"),this.itemStats.toggle()},o.prototype.updateStats=function(e,t){return this.itemStats.model=e,this.itemStats.totalCount=t,this.itemStats.render()},o}(Backbone.View)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Views.CommentsPager=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.template=JST["comments/comments_pager"],o.prototype.tagName="div",o.prototype.className="vc-paging comments-paging",o.prototype.events={"click .vc-paging-btn":"onLoadNextPageClick"},o.prototype.initialize=function(){},o.prototype.render=function(){return $(this.el).html(this.template()),this},o.prototype.onLoadNextPageClick=function(e){return e.preventDefault(),this.model.set("currentPage",this.model.get("currentPage")+1),!1},o.prototype.show=function(){return $(this.el).show()},o.prototype.hide=function(){return $(this.el).hide()},o.prototype.setLoading=function(){return $(this.el).addClass("vc-loading")},o.prototype.removeLoading=function(){return $(this.el).removeClass("vc-loading")},o}(Backbone.View)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,o=function(e,t){function o(){this.constructor=e}for(var i in t)n.call(t,i)&&(e[i]=t[i]);return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e};Vicomi.Views.Recommendations=function(n){function i(){return this.prependComment=t(this.prependComment,this),this.appendComment=t(this.appendComment,this),e=i.__super__.constructor.apply(this,arguments)}return o(i,n),i.prototype.template=JST["comments/comment_collection"],i.prototype.className="comments-ul",i.prototype.tagName="ul",i.prototype.initialize=function(){return this.collection.on("reset",this.render,this),this.collection.on("add",this.appendComment,this)},i.prototype.render=function(){return $(this.el).html(this.template()),this.collection.each(this.appendComment),this},i.prototype.appendComment=function(e){var t;return t=new Vicomi.Views.RecommendedComment({model:e}),$(this.el).append(t.render().el)},i.prototype.prependComment=function(e){var t;return t=new Vicomi.Views.RecommendedComment({model:e}),$(this.el).prepend(t.render().el)},i}(Backbone.View)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Views.RecommendedComment=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.template=JST["comments/recommended_comment"],o.prototype.tagName="li",o.prototype.initialize=function(){return this.categories=this.model.get("discussion").get("source").get("categories")},o.prototype.render=function(){return $(this.el).html(this.template({commentViewModel:this.prepareModelForView()})),this},o.prototype.prepareModelForView=function(){var e;return this.model.get("author")instanceof Backbone.Model||this.model.set("author",new Vicomi.Models.Author(this.model.get("author"))),e={comment:{id:this.model.id,content:this.model.get("text"),display_content:this.getDisplayContent(this.model.get("text")),title:this.model.get("title"),time:moment(this.model.get("posted")).lang(Vicomi.Globals.discussion.get("locale")).fromNow(),has_replies:this.model.get("sons_count")>0,replies_count:this.model.get("sons_count"),author:{is_anonymous:this.model.get("author").get("is_anonymous"),id:this.model.get("author").get("id"),name:this.model.get("author").get("name"),location:this.model.get("author").get("location"),picture:this.model.get("author").get("picture")},is_reply:null!=this.model.get("parent_comment_id"),item_virtual_good:"",is_anonymous_view:!1,format:"recommend_comment",category:this.getCategoryById(this.model.get("category_id")),is_default_format:!0,enable_delete:!1,discussion:{id:this.model.get("discussion").id,url:this.model.get("discussion").get("discussion_url"),title:this.model.get("discussion").get("title"),source:{id:this.model.get("discussion").get("source").id,url:this.model.get("discussion").get("source").get("host"),display_name:this.model.get("discussion").get("source").get("name")}}},categories:this.categories}
},o.prototype.getCategoryById=function(e){return _.find(this.categories,function(t){return t.id===e})},o.prototype.getDisplayContent=function(e){return e},o}(Backbone.View)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Views.CommentsApp=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.template=JST["layout/comments_app"],o.prototype.tagName="div",o.prototype.events={"click #remember-me-checkbox":"checkBoxClicked"},o.prototype.initialize=function(){var e;return e=new Vicomi.Collections.Comments,e.discussionId=Vicomi.Globals.discussion.id,this.headerView=new Vicomi.Views.Header({categories:Vicomi.Globals.discussion.get("categories"),itemStats:Vicomi.Globals.discussion.get("category_aggregations"),totalCount:Vicomi.Globals.discussion.get("num_comments")}),this.commentsView=new Vicomi.Views.CommentsPage({collection:e}),this.addCommentView=Vicomi.GetAddCommentView(Vicomi.Globals.discussion,e,!0,!1),this.listenTo(this.addCommentView,"commentCreated",this.prependComment),this.contentView=this.commentsView},o.prototype.render=function(){var e,t,n,o,i;return $(this.el).html(this.template()),i=Vicomi.Globals.discussion.get("should_display_ads"),i&&(e=Vicomi.Globals.discussion.get("ads_token"),o="${PUB_URL}",e&&""!==e&&(o=e),n="<script type='text/javascript' src='http://aff.adland.co.il/scripts/banner.php?a_aid=5201570a7ef9e&a_bid=7aaa5695'></script>",t=new Injector({container:$(this.el).children(".vc-top-ad")[0]}),t.insert(n)),$(this.el).append(this.headerView.render().el),$(this.el).append(this.addCommentView.render().el),$(this.el).append(this.contentView.render().el),$("input, textarea").placeholder(),this},o.prototype.renderContent=function(e){return this.contentView=e,$(this.el).children("#content").remove(),$(this.el).append(this.contentView.render().el),$("input, textarea").placeholder()},o.prototype.renderComments=function(){return this.renderContent(this.commentsView)},o.prototype.loadProfile=function(e){var t;return t=new Vicomi.Models.Profile({id:e}),t.fetch({success:function(e){return e.validateValues()}}),t.on("change",this.renderProfile,this)},o.prototype.renderProfile=function(e){var t;return t=new Vicomi.Views.Profile({model:e}),this.renderContent(t),this.hideAddComment(),this.headerView.showBackToComments()},o.prototype.renderAuthView=function(e){return this.renderContent(e),this.hideAddComment(),this.headerView.showBackToComments()},o.prototype.hideHeader=function(){return this.headerView.remove()},o.prototype.hideAddComment=function(){return this.addCommentView.remove()},o.prototype.onLoginStatuschange=function(){return this.headerView.render(),this.contentView.render(),this.addCommentView.render(),$("#vc-container").children(".modal-backdrop").remove()},o.prototype.showAlert=function(e,t){var n;return n=new Vicomi.Views.Alert({type:e,message:t}),$(this.el).children("#content").prepend(n.render().el)},o.prototype.prependComment=function(e){return this.commentsView.commentsView.prependComment(e)},o.prototype.onAddCommentsSuccess=function(e,t){var n,o;return!Vicomi.Globals.discussion.get("should_moderate")&&(o=_.clone(Vicomi.Globals.discussion.get("category_aggregations")),n=_.find(o,function(t){return t.category_id===e.get("category_id")}),n||(n={category_id:e.get("category_id"),votes:0},o.push(n)),n.votes+=1,Vicomi.Globals.discussion.set("category_aggregations",o),Vicomi.Globals.discussion.set("num_comments",Vicomi.Globals.discussion.get("num_comments")+1),this.commentsView.updateStats(Vicomi.Globals.discussion.get("category_aggregations"),Vicomi.Globals.discussion.get("num_comments")),t)?this.shareComment(e):void 0},o.prototype.shareComment=function(e,t){var n,o,i;return o=e.get("category_id"),n=_.find(Vicomi.Globals.discussion.get("categories"),function(e){return e.id===o}),i={method:"feed",display:"popup",link:window.location.origin+"/facebook/comment/"+e.id,picture:n.extra_large_image,name:Vicomi.Globals.discussion.get("title"),caption:e.get("title"),description:e.get("text")},FB.ui(i,function(e){return console.log(e)}),$("#fb-root").each(function(){return $(this).css("top",t)})},o.prototype.checkBoxClicked=function(){},o}(Backbone.View)}.call(this),function(){var e,t={}.hasOwnProperty,n=function(e,n){function o(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return o.prototype=n.prototype,e.prototype=new o,e.__super__=n.prototype,e};Vicomi.Views.DateFilter=function(t){function o(){return e=o.__super__.constructor.apply(this,arguments)}return n(o,t),o.prototype.template=JST["layout/date_filter"],o.prototype.tagName="div",o.prototype.className="vc-date-filter",o.prototype.events={"click .date-select-btn":"onOpenClick","click .date-order-option":"onOptionSelected","mouseleave .vc-date-select-container":"onMouseLeave"},o.prototype.initialize=function(e){ret...ent",this.repliesCollection=new Vicomi.Collections.Replies,this.repliesCollection.replyTo=this.model.id,this.addCommentView=Vicomi.GetAddCommentView(Vicomi.Globals.discussion,this.repliesCollection,!1,!0),this.categories=this.model.get("discussion").get("source").get("categories")},o.prototype.render=function(){return $(this.el).html(this.template({commentViewModel:this.prepareModelForView()})),$(this.el).children(".vc-comment").children(".replies").after(this.addCommentView.render().el),this.categories.length>6?$(this.el).children(".vc-comment").children(".vc-comment-inner").find(".vote-emotion-select").addClass("col-6"):$(this.el).children(".vc-comment").children(".vc-comment-inner").find(".vote-emotion-select").removeClass("col-6"),this},o.prototype.prepareModelForView=function(){var e;return this.model.get("author")instanceof Backbone.Model||this.model.set("author",new Vicomi.Models.Author(this.model.get("author"))),e={comment:{id:this.model.id,content:this.model.get("text"),display_content:this.getDisplayContent(this.model.get("text")),title:this.model.get("title"),time:moment(this.model.get("posted")).lang(Vicomi.Globals.discussion.get("locale")).fromNow(),has_replies:this.model.get("sons_count")>0,replies_count:this.model.get("sons_count"),author:{is_anonymous:this.model.get("author").get("is_anonymous"),id:this.model.get("author").get("id"),name:this.model.get("author").get("name"),location:this.model.get("author").get("location"),picture:this.model.get("author").get("picture")},is_reply:!1,item_virtual_good:"",is_anonymous_view:this.model.get("author").get("is_anonymous"),format:this.format,category:this.getCategoryById(this.model.get("category_id")),total_votes:this.model.get("votes_count"),category_aggregations:this.getVotes(this.model.get("category_aggregations")),is_default_format:!1,enable_delete:!1,discussion:{url:this.model.get("discussion").get("discussion_url"),title:this.model.get("discussion").get("title"),source:{url:this.model.get("discussion").get("source").get("host"),display_name:this.model.get("discussion").get("source").get("name")}}},categories:this.categories}},o.prototype.fetchReplies=function(){var e;return e={page:0,per_page:10,discussion_id:this.model.get("discussion_id")},this.repliesCollection.fetch({data:e},{wait:!0}),this.repliesView=new Vicomi.Views.Comments({collection:this.repliesCollection,categories:Vicomi.Globals.discussion.get("categories"),el:$(".replies")})},o.prototype.getCategoryById=function(e){return _.find(this.categories,function(t){return t.id===e})},o.prototype.getDisplayContent=function(e){var t,n;return t=e.substr(0,parseInt(I18n.t("comment_display_length"))),e.length>t.length&&(n=t.lastIndexOf(" "),t=t.substring(0,n)),t},o.prototype.getVotes=function(e){var t;return t={},_.each(this.categories,function(e){return t[e.id]=_.extend({},e,{votes:0})}),_.each(e,function(e){return t[e.category_id].votes=e.votes}),t},o.prototype.isOpened=function(){return $(this.el).children(".vc-comment").children(".vc-comment-inner").hasClass("opened")},o.prototype.onMouseOver=function(e){return e.preventDefault(),e.stopPropagation(),$(e.currentTarget).find(".vc-comment-widgets").children(".hover-element").show()},o.prototype.onMouseLeave=function(e){return e.preventDefault(),e.stopPropagation(),$(e.currentTarget).find(".vc-comment-widgets").children(".hover-element").hide()},o.prototype.onClick=function(){return this.isOpened()?void 0:($(this.el).children(".vc-comment").children(".vc-comment-inner").addClass("opened"),this.expand())},o.prototype.onExpandClick=function(e){return e.preventDefault(),e.stopPropagation(),this.isOpened()?($(e.currentTarget).text("Expand"),this.collapse()):($(e.currentTarget).text("Collapse"),this.expand()),$(this.el).children(".vc-comment").children(".vc-comment-inner").toggleClass("opened")},o.prototype.expand=function(){var e,t,n,o,i,s;return this.addCommentView.show(),i=Vicomi.Globals.discussion.get("should_display_ads"),i&&(e=Vicomi.Globals.discussion.get("ads_token"),o="${PUB_URL}",e&&""!==e&&(o=e),s=$(this.el).children(".vc-comment").children(".vc-comment-ad")[0],0===s.childElementCount&&(n="<SCRIPT TYPE='text/javascript' SRC='http://ad.adserverplus.com/st?ad_type=ad&ad_size=468x60&section=4522141&pub_url="+o+"'></SCRIPT>",t=new Injector({container:$(this.el).children(".vc-comment").children(".vc-comment-ad")[0]}),t.insert(n),$(this.el).children(".vc-comment").addClass("show-ad")),$(this.el).children(".vc-comment").children(".vc-comment-ad").show()),null==this.repliesView&&this.fetchReplies(),$(this.el).children(".vc-comment").children(".replies").show()},o.prototype.collapse=function(){return this.addCommentView.hide(),$(this.el).children(".vc-comment").children(".vc-comment-ad").hide(),$(this.el).children(".vc-comment").children(".replies").hide()},o.prototype.onAuthorClick=function(e){return e.preventDefault(),e.stopPropagation(),Vicomi.Routers.DiscussionRouter.navigate("profile/"+this.model.get("author").get("user_id"),{trigger:!0})
},o.prototype.onOptionsClick=function(e){return e.preventDefault(),e.stopPropagation(),$(e.currentTarget).parent().toggleClass("opened")},o.prototype.onOptionsLeave=function(){return this.hideOptions()},o.prototype.hideOptions=function(){return $(this.el).children(".vc-comment").children(".vc-comment-inner").find(".vc-comment-options").removeClass("opened")},o.prototype.onVoteClick=function(e){var t,n,o;return e.preventDefault(),e.stopPropagation(),t=$(e.currentTarget).parent(),t.hasClass("selected")?this.clearVotedEmotion(t):(o=new Vicomi.Models.VoteComment({id:this.model.id,category_id:t.attr("data-emotion-id")}),n=this,o.save(o.attributes,{success:function(e){return n.showAlert("success",I18n.t("message_vote_success")),n.setVotedEmotion(t),n.updateVotes(e)},error:function(){return alert("Error")}}))},o.prototype.setVotedEmotion=function(e){var t;return e.addClass("selected"),this.updateVotesCountsView(e),t=$(this.el).children(".vc-comment").children(".vc-comment-inner").find(".vote-emotion").children("ul"),t.children(":not(.selected)").hide(),t.parent().animate({width:"48px",height:"32px"},function(){return $(this).addClass("state-selected")})},o.prototype.updateVotesCountsView=function(e){return e.children(".vote-emotion-count").html(parseInt(e.children(".vote-emotion-count").text())+1)},o.prototype.clearVotedEmotion=function(e){var t,n;return e.removeClass("selected"),t=$(this.el).children(".vc-comment").children(".vc-comment-inner").find(".vote-emotion").children("ul"),t.parent().removeClass("state-selected"),n=this.categories.length>6?"202px":"170px",t.parent().animate({width:n,height:"52px"},function(){return $(this).children("ul").children().show()})},o.prototype.onFlagClick=function(e){var t,n;return e.preventDefault(),e.stopPropagation(),t=new Vicomi.Models.FlagComment({id:this.model.id}),n=this,t.save(t.attributes,{success:function(){return n.showAlert("success",I18n.t("message_flag_success")),n.hideOptions()},error:function(){return alert("Error")}})},o.prototype.onStatsClick=function(e){return e.preventDefault(),e.stopPropagation(),this.hideOptions(),null==this.commentStats&&(this.commentStats=new Vicomi.Views.Stats({model:this.model.get("category_aggregations"),categories:this.categories,totalCount:this.model.get("votes_count")})),$(this.el).children(".vc-comment").children(".vc-comment-stats").append(this.commentStats.render().el),$(this.el).children(".vc-comment").children(".vc-comment-stats").show()},o.prototype.updateVotes=function(e){var t,n;return n=_.clone(this.model.get("category_aggregations")),t=_.find(n,function(t){return t.category_id===e.get("category_id")}),t||(t={category_id:e.get("category_id"),votes:0},n.push(t)),t.votes+=1,this.model.set("votes_count",this.model.get("votes_count")+1),this.model.set("category_aggregations",n)},o.prototype.onFBClick=function(e){return e.preventDefault()},o.prototype.onDeleteClick=function(e){return e.preventDefault(),e.stopPropagation(),Vicomi.Globals.loggedIn&&Vicomi.Globals.currentUser.get("_id")===this.model.get("author").get("id")?alert("You can delete"):alert("You are not allowed to delete this comment")},o.prototype.showAlert=function(e,t){return null!=Vicomi.Views.commentsAppview?Vicomi.Views.commentsAppview.showAlert(e,t):void 0},o.prototype.onCloseStatsClick=function(e){return e.preventDefault(),e.stopPropagation(),$(this.el).children(".vc-comment").children(".vc-comment-stats").hide()},o.prototype.onCategoryClick=function(e){var t;return e.preventDefault(),e.stopPropagation(),t=$(e.currentTarget).attr("href"),Vicomi.Views.commentsAppview.commentsView.categoryFilter.changeSelectedCategory(t)},o.prototype.onUserAvatarOver=function(){return this.model.get("author").get("is_anonymous")?void 0:this.timeout=setTimeout(_.bind(this.createTooltip,this),500)},o.prototype.createTooltip=function(){var e;return null==this.userTooltip?(e=new Vicomi.Models.UserTooltip({id:this.model.get("author").get("user_id")}),this.userTooltip=new Vicomi.Views.Tooltip({model:e}),e.once("change",this.renderUserTooltip,this)):void 0},o.prototype.renderUserTooltip=function(){return $(this.el).children(".vc-comment").children(".vc-comment-inner").find(".vc-comment-user-avatar").append(this.userTooltip.render().el)},o.prototype.onUserAvatarLeave=function(){return this.removeTooltip()},o.prototype.removeTooltip=function(){return null!=this.userTooltip?(this.userTooltip.remove(),this.userTooltip=null,clearTimeout(this.timeout)):void 0},o}(Backbone.View)}.call(this),function(){var e,t=function(e,t){return function(){return e.apply(t,arguments)}},n={}.hasOwnProperty,o=function(e,t){function o(){this.constructor=e}for(var i in t)n.call(t,i)&&(e[i]=t[i]);return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e};Vicomi.Views.UserComments=function(n){function i(){return this.appendComment=t(this.appendComment,this),e=i.__super__.constructor.apply(this,arguments)}return o(i,n),i.prototype.template=JST["comments/comment_collection"],i.prototype.id="user-com...bals.discussion?(e=Vicomi.Globals.discussion.get("widgetType"),"recommend"===e?this.displayRecomendations(Vicomi.Globals.discussion):this.displayDiscussion(Vicomi.Globals.discussion)):void 0},o.prototype.initilizeDiscussion=function(){var e,t,n,o,i,s,r,a,c,l;return c=decodeURIComponent(this.getQueryVariable("url")),a=encodeURIComponent(this.getQueryVariable("title")),l=decodeURIComponent(this.getQueryVariable("type")),e=this.getQueryVariable("access_token"),s=decodeURIComponent(this.getQueryVariable("image")),n=encodeURIComponent(this.getQueryVariable("description")),i=decodeURIComponent(this.getQueryVariable("externalid")),t=decodeURIComponent(this.getQueryVariable("authorid")),r=decodeURIComponent(this.getQueryVariable("tags")),o=new Vicomi.Models.Discussion({discussion_url:c,title:a,widgetType:l,image:s,description:n,externalid:i,access_token:e,tags:r,authorid:t}),"recommend"===l?o.once("change",this.displayRecomendations,this):o.once("change",this.displayDiscussion,this)},o.prototype.displayDiscussion=function(e){return I18n.locale=e.get("locale"),"he"===e.get("locale")&&$("body").addClass("rtl"),Vicomi.Globals.discussion=e,Vicomi.Views.commentsAppview=new Vicomi.Views.CommentsApp({el:$("#vc-container")}),Vicomi.Views.commentsAppview.render()},o.prototype.displayRecomendations=function(e){return I18n.locale=e.get("locale"),"he"===e.get("locale")&&$("body").addClass("rtl"),Vicomi.Globals.discussion=e,Vicomi.Views.recommendationsAppview=new Vicomi.Views.RecommendationsApp({el:$("#vc-container")}),Vicomi.Views.recommendationsAppview.render()},o.prototype.displayProfile=function(e){return Vicomi.Views.commentsAppview.loadProfile(e)},o.prototype.onFBShareSuccess=function(){},o.prototype._extractParameters=function(e,t){var n;return n=e.exec(t).slice(1)},o.prototype.getCommentsInitURL=function(e,t,n,o){var i,s,r,a,c;return s=encodeURIComponent(e),i=encodeURIComponent(t),r=document.getElementsByTagName("article")[0],c="/init/"+s+"/"+i,c+=null!=n?"/"+n:"",r&&(a=r.getAttribute("id"),-1!==a.indexOf("node-")&&(a=a.substr(5)),c+="&externalid="+a),c+="?access_token="+o},o.prototype.getQueryVariable=function(e){var t,n,o,i,s,r,a;for(n=window.location.search.substring(1),n=decodeURIComponent(n),s=n.split("&"),r=0,a=s.length;a>r;r++)if(t=s[r],o=t.substr(0,t.indexOf("=")),i=t.substr(t.indexOf("=")+1),o===e)return unescape(i);return""},o}(Backbone.Router)}.call(this),function(){jQuery(function(){return $("body").prepend('<div id="fb-root"></div>'),$.ajax({url:""+window.location.protocol+"//connect.facebook.net/en_US/all.js",dataType:"script",cache:!0})}),window.fbAsyncInit=function(){return FB.init({appId:"369446866481149",cookie:!0}),$("#fb_sign_in").click(function(e){return e.preventDefault(),FB.login(function(e){return e.authResponse?window.location="/users/auth/facebook":void 0})}),$("#sign_out").click(function(){return FB.getLoginStatus(function(e){return e.authResponse?FB.logout():void 0}),!0})}}.call(this),function(e,t,n){function o(e){var t={},o=/^jQuery\d+$/;return n.each(e.attributes,function(e,n){n.specified&&!o.test(n.name)&&(t[n.name]=n.value)}),t}function i(e,o){var i=this,s=n(i);if(i.value==s.attr("placeholder")&&s.hasClass("placeholder"))if(s.data("placeholder-password")){if(s=s.hide().next().show().attr("id",s.removeAttr("id").data("placeholder-id")),e===!0)return s[0].value=o;s.focus()}else i.value="",s.removeClass("placeholder"),i==t.activeElement&&i.select()}function s(){var e,t=this,s=n(t),r=this.id;if(""==t.value){if("password"==t.type){if(!s.data("placeholder-textinput")){try{e=s.clone().attr({type:"text"})}catch(a){e=n("<input>").attr(n.extend(o(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":r}).bind("focus.placeholder",i),s.data({"placeholder-textinput":e,"placeholder-id":r}).before(e)}s=s.removeAttr("id").hide().prev().attr("id",r).show()}s.addClass("placeholder"),s[0].value=s.attr("placeholder")}else s.removeClass("placeholder")}var r,a,c="placeholder"in t.createElement("input"),l="placeholder"in t.createElement("textarea"),u=n.fn,p=n.valHooks;c&&l?(a=u.placeholder=function(){return this},a.input=a.textarea=!0):(a=u.placeholder=function(){var e=this;return e.filter((c?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":i,"blur.placeholder":s}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e},a.input=c,a.textarea=l,r={get:function(e){var t=n(e);return t.data("placeholder-enabled")&&t.hasClass("placeholder")?"":e.value},set:function(e,o){var r=n(e);return r.data("placeholder-enabled")?(""==o?(e.value=o,e!=t.activeElement&&s.call(e)):r.hasClass("placeholder")?i.call(e,!0,o)||(e.value=o):e.value=o,r):e.value=o}},c||(p.input=r),l||(p.textarea=r),n(function(){n(t).delegate("form","submit.placeholder",function(){var e=n(".placeholder",this).each(i);setTimeout(function(){e.each(s)},10)})}),n(e).bind("beforeunload.placeholder",function(){n(".placeholder").each(function(){this.value=""})}))}(this,document,jQuery);
